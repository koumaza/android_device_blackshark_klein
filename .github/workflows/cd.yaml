name: CD
on:
  push:
    branches: [ wip ]
    tags:
      - '!*'
  pull_request:
    branches: [ wip ]
jobs:
  Tag:
    outputs:
      generated_tag: ${{ steps.BumpTag.outputs.new_tag }}
    runs-on: ubuntu-20.04
    steps:
      - name: CheckOut
        uses: actions/checkout@main
        with:
          fetch-depth: '0'
      - name: Bump version and push tag
        id: BumpTag
        uses: anothrNick/github-tag-action@master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          WITH_V: true
          DEFAULT_BUMP: patch
  Build:
    needs: [Tag]
    runs-on: ubuntu-20.04
    steps:
    - name: Env
      shell: bash
      run: bash purge.sh
    - name: Build
      shell: bash
      run: |
        echo
        df
        du -hcs /
